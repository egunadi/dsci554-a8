<!DOCTYPE html>
<html>

<head>
  <title>DSCI 554 Lab Pie Chart</title>

  <link href="css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css">

  <link href="css/bootstrap-icons.css" rel="stylesheet">

  <link rel="stylesheet" href="css/github-dark-dimmed.min.css">
  <script src="js/highlight.min.js"></script>

  <script src="js/highlightjs-copy.min.js"></script>
  <link rel="stylesheet" href="css/highlightjs-copy.min.css" />

  <script>
    hljs.highlightAll();
    hljs.addPlugin(new CopyButtonPlugin());
  </script>

  <script src="js/d3.min.js"></script>

  <style>
    .arc text {
      font: 10px sans-serif;
      text-anchor: middle;
    }

    .arc path {
      stroke: #fff;
    }
  </style>
</head>

<body>
  <div>
  <svg id="pie-chart" width="960" height="500"></svg>

  <script>
    d3.json('data.json', d => {
      d.population = +d.population;
      return d;
    }).then(data => {
      var svg = d3.select('#pie-chart'),
        width = +svg.attr('width'),
        height = +svg.attr('height'),
        radius = Math.min(width, height) / 2,
        g = svg.append('g')
          .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');

      var color = d3.scaleOrdinal(['#98abc5', '#8a89a6', '#7b6888', '#6b486b']);

      var pie = d3.pie()
        .value(d => d.population)
        .sort(null)
        // .sort(function(a, b) { return a.age.localeCompare(b.age); })   //sort by age
        .sortValues(d3.descending);

      var path = d3.arc()
        .outerRadius(radius)
        .innerRadius(0);  //.innerRadius(150);  //make a donut chart by changing the inner radius

      var label = d3.arc()
        .outerRadius(radius - 40)
        .innerRadius(radius - 40);

      var arc = g.selectAll('.arc')
        .data(pie(data))
        .enter()
        .append('g')
        .attr('class', 'arc');

      arc.append('path')
        .attr('d', path)
        .attr('fill', d => color(d.data.age));

      arc.append('text')
        .attr('transform', d => 'translate(' + label.centroid(d) + ')')
        .text(d => d.data.age);
    });
  </script>
</body>

</html>