<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Population Comparison in 2020</title>
    <!-- Add Bootstrap CSS link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Add D3.js library -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
        /* CSS for the legend */
        .legend {
            display: flex;
            flex-direction: column;
            margin-top: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }
    </style>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container-fluid">
        <!-- Dashboard Header -->
        <div class="row dashboard-header">
            <div class="col">
                <h1 class="mt-4">Population Comparison in 2020</h1>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Population in 2020</h5>
                    <div id="pie-chart" class="chart">
                        <div id="legend" class="legend"></div>
                    </div>
                </div>
            </div>
            <div class="mt-4 text-left">
                <a href="index.html" class="btn btn-primary btn-sm">Back to Home</a>
            </div>
        </div>
    </div>
    <script>
        var margin = { top: 20, right: 20, bottom: 40, left: 60 };
        var width = document.getElementById("pie-chart").offsetWidth - margin.left - margin.right;
        var height = 350 - margin.top - margin.bottom;

        // Create an SVG element
        var svg = d3.select("#pie-chart")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        // Sample data for population in 2020
        var data = [
            { Country: "Japan", Population: 126476461 },
            { Country: "Korea", Population: 51780579 },
            { Country: "Indonesia", Population: 273523615 },
            { Country: "China", Population: 1439323776 },
            { Country: "Singapore", Population: 5850342 }
        ];

        // Extract unique country names from populationData
        const countries = Array.from(new Set(data.map(d => d.Country)));

        // Create D3 color scale
        const colorScale = d3.scaleOrdinal()
            .domain(countries)
            .range(d3.schemeTableau10);

        // Create a pie chart layout
        var pie = d3.pie()
            .value(function (d) { return d.Population; });

        // Generate the pie chart segments and bind the data
        var arcs = svg.selectAll("arc")
            .data(pie(data))
            .enter()
            .append("g")
            .attr("class", "arc");

        // Draw each arc segment
        arcs.append("path")
            .attr("d", d3.arc()
                .innerRadius(0)
                .outerRadius(Math.min(width, height) / 2 - 10)) // Adjusted outer radius to fit inside the card
            .attr("fill", function (d) { return colorScale(d.data.Country); });

        // Generate legend
        var legend = d3.select("#legend")
            .selectAll("div")
            .data(countries)
            .enter()
            .append("div")
            .attr("class", "legend-item");

        legend.append("div")
            .attr("class", "legend-color")
            .style("background-color", function (d) { return colorScale(d); });

        legend.append("div")
            .attr("class", "legend-label")
            .text(function (d) { return d; });
    </script>

    <!-- Add Bootstrap JS and Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
</body>

</html>
