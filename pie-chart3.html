<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Population Comparison in 2020</title>
    <!-- Add Bootstrap CSS link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Add D3.js library -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <div class="container-fluid">
        <!-- Dashboard Header -->
        <div class="row dashboard-header">
            <div class="col">
                <h1 class="mt-4">Population Comparison in 2020</h1>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Population in 2020</h5>
                    <div id="pie-chart" class="chart"></div>
                </div>
            </div>
            <div class="mt-4 text-left">
                <a href="index.html" class="btn btn-primary btn-sm">Back to Home</a>
            </div>
        </div>
    </div>
    <script>
        // Define the chart dimensions and margins
        var width = 300; // Adjusted width to fit inside the card
        var height = 300; // Adjusted height to fit inside the card

        // Create an SVG element
        var svg = d3.select("#pie-chart")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

        // Sample data for population in 2020
        var data = [
            { Country: "Japan", Population: 126476461 },
            { Country: "Korea", Population: 51780579 },
            { Country: "Indonesia", Population: 273523615 },
            { Country: "China", Population: 1439323776 },
            { Country: "Singapore", Population: 5850342 }
        ];

        // Extract unique country names from populationData
        const countries = Array.from(new Set(data.map(d => d.Country)));

        // Create D3 color scale
        const colorScale = d3.scaleOrdinal()
            .domain(countries)
            .range(d3.schemeTableau10);

        // Create a pie chart layout
        var pie = d3.pie()
            .value(function (d) { return d.Population; });

        // Generate the pie chart segments and bind the data
        var arcs = svg.selectAll("arc")
            .data(pie(data))
            .enter()
            .append("g")
            .attr("class", "arc");

        // Draw each arc segment
        arcs.append("path")
            .attr("d", d3.arc()
                .innerRadius(0)
                .outerRadius(Math.min(width, height) / 2 - 10)) // Adjusted outer radius to fit inside the card
            .attr("fill", function (d) { return colorScale(d.data.Country); });

        // // Add labels to the arcs
        // arcs.append("text")
        //     .attr("transform", function (d) {
        //         return "translate(" + d3.arc().innerRadius(0).outerRadius(Math.min(width, height) / 2 - 10).centroid(d) + ")";
        //     })
        //     .attr("text-anchor", "middle")
        //     .text(function (d) { return d.data.Country; });

        // Add legend using D3 color scale
        const legend = svg.append("g")
            .attr("class", "legend")
            .attr("transform", `translate(10, 10)`); // Adjust the translation values

        const legendItems = legend.selectAll(".legend-item")
            .data(countries)
            .enter()
            .append("g")
            .attr("class", "legend-item")
            .attr("transform", (d, i) => `translate(0, ${i * 25})`); // Adjust the spacing between legend items

        legendItems.append("rect")
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", d => colorScale(d)); // Use the color scale for legend items

        legendItems.append("text")
            .attr("x", 30)
            .attr("y", 10)
            .text(d => d);

    </script>

    <!-- Add Bootstrap JS and Popper.js -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
</body>

</html>
